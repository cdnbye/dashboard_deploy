var x=Object.defineProperty,T=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var w=(p,a,e)=>a in p?x(p,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):p[a]=e,A=(p,a)=>{for(var e in a||(a={}))F.call(a,e)&&w(p,e,a[e]);if(b)for(var e of b(a))q.call(a,e)&&w(p,e,a[e]);return p},v=(p,a)=>T(p,D(a));var u=(p,a,e)=>new Promise((l,o)=>{var c=t=>{try{i(e.next(t))}catch(s){o(s)}},n=t=>{try{i(e.throw(t))}catch(s){o(s)}},i=t=>t.done?l(t.value):Promise.resolve(t.value).then(c,n);i((e=e.apply(p,a)).next())});import{$ as r,y as P}from"./bootstrap-PGBUDbCq.js";import{u as O}from"./form-n2PTTWpZ.js";import{c as V}from"./app-BDMbAMBy.js";import{a5 as W,bw as C,ag as k,ah as B,ai as L,n as R,ab as d}from"../jse/index-index-BXx06mpc.js";import{u as U}from"./use-drawer-BIbaYHg9.js";const J=W({__name:"create-drawer",emits:["success"],setup(p,{emit:a}){const e=a,[l,o]=O({layout:"vertical",handleSubmit:i,schema:[{component:"Input",fieldName:"app_name",label:"APP Name",componentProps:{placeholder:r("page.app.appName")},rules:"required"},{component:"Input",fieldName:"app_id",label:"APP ID",help:r("page.app.appID"),componentProps:{placeholder:r("page.app.appIdTip")},rules:"required"},{component:"Input",fieldName:"play_url",label:"Introduction URL",help:r("page.app.introTip"),componentProps:{placeholder:"https://introduction_to_app/index.html"},rules:"required"},{component:"Select",fieldName:"platform",label:"Platform",help:r("page.app.introTip"),componentProps:{class:"w-full",options:[{label:"Android/AndroidTV",value:"android"},{label:"iOS/tvOS/macOS/Flutter/ReactNative/UniApp",value:"ios"},{label:"Electron/Windows/Linux",value:"pc"}]},rules:"required"},{component:"Input",fieldName:"signature",label:"App Signature",help:r("page.app.signatureTip"),componentProps:{placeholder:"Optional"},dependencies:{if(t){return t.platform==="android"},triggerFields:["platform"]}}],showDefaultActions:!1}),[c,n]=U({onConfirm:()=>u(this,null,function*(){yield o.submitForm()})});function i(t){return u(this,null,function*(){var f,g,_,h;if(!(yield o.validate()).valid)return;n.setState({loading:!0});const S=(f=t.app_name)==null?void 0:f.trim(),m=(g=t.app_id)==null?void 0:g.trim(),I=(_=t.play_url)==null?void 0:_.trim(),N=(h=t.signature)==null?void 0:h.trim();if(m.startsWith("http://")||m.startsWith("https://")){P.error({message:r("common.error"),description:r("page.app.websiteWarn")});return}const[y]=yield C(V(v(A({},t),{app_name:S,app_id:m,play_url:I,signature:N})));n.setState({loading:!1}),!y&&(P.success({message:r("common.success"),description:r("page.app.createItemSuccess")}),n.close(),e("success"))})}return(t,s)=>(k(),B(d(c),{title:d(r)("page.app.createTitle"),class:"w-1/2"},{default:L(()=>[R(d(l),{class:"mx-4"})]),_:1},8,["title"]))}});export{J as _};
