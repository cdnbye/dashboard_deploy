var m=(w,h,r)=>new Promise((C,n)=>{var v=i=>{try{p(r.next(i))}catch(u){n(u)}},x=i=>{try{p(r.throw(i))}catch(u){n(u)}},p=i=>i.done?C(i.value):Promise.resolve(i.value).then(v,x);p((r=r.apply(w,h)).next())});import{a as E,q as G,$ as t,B as _,bc as L,t as M,v as V}from"./bootstrap-SKctUie3.js";import{u as O}from"./vxe-table-CfGRJCLB.js";import{f as R,s as j,d as F,a as I}from"./domain-Cy3FhfO2.js";import{u as Y}from"./app-Bz8GH1Kr.js";import{_ as H}from"./bind-drawer.vue_vue_type_script_setup_true_lang-DulBjaO2.js";import{_ as J}from"./viladate-modal.vue_vue_type_script_setup_true_lang-BuaN7ttS.js";import{_ as K}from"./copy-token.vue_vue_type_script_setup_true_lang-zVrDrnU6.js";import{_ as Q}from"./page.vue_vue_type_script_setup_true_lang-Dgq6zLp-.js";import{a5 as X,R as Z,Y as ee,ah as k,ai as s,ab as a,ag as b,n as l,ar as S,ap as d,aq as f,al as D,bw as $}from"../jse/index-index-0SEuuMhD.js";import{u as ae}from"./use-drawer-WeeVlx5E.js";import{u as te}from"./use-modal-CeNy_I9O.js";import{P as oe}from"./index-2WM4XbSS.js";import"./loading-BVj1NiH4.js";import"./form-ufAcWega.js";import"./RightOutlined-BmsLIaO2.js";import"./index-DddsfUBR.js";import"./index-BQGcMYzE.js";import"./CopyOutlined-CUICu9G8.js";import"./copy-ByS1NwOS.js";import"./x-Cpey3BCi.js";const ie={class:"flex w-full flex-col md:flex-row"},se={class:"mt-2 flex items-center md:ml-auto md:mt-0"},Ve=X({__name:"index",setup(w){const h=Y(),r=E(),C=G(),n=Z(!1),[v,x]=ae({connectedComponent:H}),[p,i]=te({connectedComponent:J}),u=ee({checkboxConfig:{highlight:!0,labelField:"name"},columns:[{field:"domain",title:t("page.domain.domain"),minWidth:200},{field:"status",title:t("page.domain.status"),width:200,slots:{default:"status"}},{field:"operation",title:t("common.operation"),slots:{default:"operation"},width:200}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:c=>m(this,[c],function*({page:e}){const o=yield R({page:e.currentPage,page_size:e.pageSize,web:1}),g=yield j();return n.value=g.exist,{items:o,total:1e3}})}}}),[B,z]=O({gridOptions:u});function N(){x.open()}function y(){return m(this,null,function*(){yield z.reload(),h.fetchAllDomainAndAppLogic()})}function P(e){return m(this,null,function*(){const[c]=yield $(F(e.id));c||(V.success({description:t("common.deleteSuccess"),message:t("common.success")}),yield y())})}function U(e){return m(this,null,function*(){const c=C.accessUserId;r.push({name:"UserClientLiveDataPerApp"}).then(()=>{h.setCurrentDomain({uid:`${c}`,id:e.id,domain:e.domain,isValid:1,native:!1})})})}function W(e){return e.blocked?t("common.illegal"):e.reviewing?t("common.reviewing"):e.disable_p2p?t("common.userClosed"):e.isValid===0?t("page.domain.unavailable"):t("common.available")}function q(){return m(this,null,function*(){const[e]=yield $(I({enabled:n.value}));e?n.value=!n.value:(V.success({message:t("common.success")}),yield y())})}function T(e){return m(this,null,function*(){i.setData(e),i.open()})}function A(e){return e.shadow||e.domain.endsWith(".localhost")||e.domain.endsWith(".superpeer")}return(e,c)=>(b(),k(a(Q),{description:a(t)("page.domain.desc"),"auto-content-height":""},{default:s(()=>[l(a(p)),l(a(v),{onSuccess:y}),l(a(B),null,{"toolbar-actions":s(()=>[S("div",ie,[l(a(_),{class:"md:mr-2",type:"primary",onClick:N},{default:s(()=>[d(f(a(t)("page.domain.bindDomain")),1)]),_:1}),l(a(K),{class:"mt-3 w-full md:mt-0 md:w-1/3"}),S("div",se,[l(a(L),{checked:n.value,"onUpdate:checked":c[0]||(c[0]=o=>n.value=o),class:"mr-2",onChange:q},null,8,["checked"]),c[1]||(c[1]=d(" Token Only "))])])]),status:s(({row:o})=>[l(a(M),{color:o.blocked||!o.isValid||o.disable_p2p?"red":"success"},{default:s(()=>[d(f(W(o)),1)]),_:2},1032,["color"])]),operation:s(({row:o})=>[o.isValid?(b(),k(a(_),{key:0,size:"small",type:"link",onClick:g=>U(o)},{default:s(()=>[d(f(a(t)("page.app.watch")),1)]),_:2},1032,["onClick"])):D("",!0),o.isValid!==1?(b(),k(a(_),{key:1,size:"small",type:"link",onClick:g=>T(o)},{default:s(()=>[d(f(a(t)("page.domain.certification")),1)]),_:2},1032,["onClick"])):D("",!0),l(a(oe),{"cancel-text":a(t)("common.cancel"),disabled:A(o),"ok-text":a(t)("common.ok"),title:a(t)("common.sureDelete"),onConfirm:g=>P(o)},{default:s(()=>[A(o)?D("",!0):(b(),k(a(_),{key:0,danger:"",size:"small",type:"link"},{default:s(()=>[d(f(a(t)("common.delete")),1)]),_:1}))]),_:2},1032,["cancel-text","disabled","ok-text","title","onConfirm"])]),_:1})]),_:1},8,["description"]))}});export{Ve as default};
