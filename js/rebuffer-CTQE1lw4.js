var b=(_,c,t)=>new Promise((r,o)=>{var m=a=>{try{f(t.next(a))}catch(s){o(s)}},i=a=>{try{f(t.throw(a))}catch(s){o(s)}},f=a=>a.done?r(a.value):Promise.resolve(a.value).then(m,i);f((t=t.apply(_,c)).next())});import{a5 as C,R as g,aW as p,Y as d,J as N,X as B,af as S,ak as $,ah as A,ab as w,bw as F,w as l,al as M}from"../jse/index-index-C5kN0FgG.js";import"./bootstrap-QC5HPXIW.js";import{c as O,D as U}from"./history-data-DR3x4v2x.js";import{_ as V}from"./not-bind-tip.vue_vue_type_script_setup_true_lang-B53kzjhJ.js";import{u as j}from"./app-DUrdUZ6y.js";import{_ as E}from"./line-chart.vue_vue_type_script_setup_true_lang-Dvo-Hib4.js";import{_ as I}from"./page.vue_vue_type_script_setup_true_lang-C2EvkboD.js";import"./use-modal-BWnJd4PN.js";import"./x-t2EEVmmI.js";import"./loading-CjfJb0X9.js";import"./domain-DYNLDaZf.js";import"./use-echarts-efeZ2R18.js";const J={class:"md:pt-5"},aa=C({__name:"rebuffer",setup(_){const c=j(),t=g("week"),r=g([p().startOf("day").subtract(1,"week"),p().startOf("day")]),o=d({xData:[],unit:"%",yName:"Rebuffer"}),m=d({}),i=d({rebuffer:[]}),f=N(()=>t.value==="week"||t.value==="month");function a(){return b(this,arguments,function*(n=r.value[0],e=r.value[1]){var h;o.xData=[],i.rebuffer=[];let u=5;f.value&&(u=1440);const D=((h=c.currentDomain)==null?void 0:h.id)||0,y={start_ts:s(n),end_ts:s(e),gran:u};if(D){const[k,R]=yield F(O(D,y));if(k)return;R.list.forEach(v=>{o.xData.push(p(v.ts*1e3).format("MM-DD")),i.rebuffer.push(Number.parseFloat((v.value*100).toFixed(2)))})}})}function s(n){return n.unix()}function x(n,e){a(n,e)}return B(()=>c.currentDomain,()=>{a()},{deep:!0}),a(),(n,e)=>(S(),$(w(I),null,{default:A(()=>[l(V),M("div",J,[l(w(U),{date:t.value,"onUpdate:date":e[0]||(e[0]=u=>t.value=u),range:r.value,"onUpdate:range":e[1]||(e[1]=u=>r.value=u),day:!1,hour:!1,"show-time":!1,onChange:x},null,8,["date","range"])]),l(E,{data:m,"option-data":o,"second-data":i,class:"mt-6"},null,8,["data","option-data","second-data"])]),_:1}))}});export{aa as default};
