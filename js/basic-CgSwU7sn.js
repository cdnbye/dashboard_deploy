var U=(T,d,e)=>new Promise((m,s)=>{var i=r=>{try{f(e.next(r))}catch(c){s(c)}},g=r=>{try{f(e.throw(r))}catch(c){s(c)}},f=r=>r.done?m(r.value):Promise.resolve(r.value).then(i,g);f((e=e.apply(T,d)).next())});import{v as j,dc as q,w as V,D as H,i as E,o as Z,u as W,b9 as J,ay as X,bi as R,a as Q,db as G,c as L,$ as C,aA as z,z as K,d7 as ee,j as ae,dd as oe,de as te,df as ne,dg as A,k as se,f as re}from"./bootstrap-CiyWlmzu.js";import{u as le}from"./app-CWvsWFBj.js";import{a5 as D,aY as ie,aZ as ue,X as N,af as S,ag as P,w as p,ah as v,ab as t,ai as ce,R as k,J as $,a6 as O,ak as M,aj as B,al as I,F as de,n as me,e as pe,bw as fe,bJ as he,a2 as ve,av as ge}from"../jse/index-index-DX6TcLw_.js";import{u as x}from"./use-modal-DGRkTv3G.js";import{u as F}from"./form-Cbk7_7El.js";import{e as be}from"./order-_YWwujoO.js";import{_ as Ce,a as _e,b as ye,c as Te}from"./layout.vue_vue_type_script_setup_true_lang-BqCCWy_D.js";import"./domain-DxFU4Atk.js";import"./x-COcrQ3Ng.js";import"./loading-C3dzF5Xb.js";import"./theme-toggle.vue_vue_type_script_setup_true_lang-BO_BULwF.js";import"./arrow-down-yJPjnVWD.js";import"./use-drawer-BZgfIivn.js";import"./copy-D77kJJAA.js";import"./rotate-cw-wOTEUBaZ.js";const Ue=j("BookOpenTextIcon",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]]),we=D({name:"LoginExpiredModal",__name:"login-expired-modal",props:ie({avatar:{default:""},codeLoginPath:{},forgetPasswordPath:{},loading:{type:Boolean},qrCodeLoginPath:{},registerPath:{},showCodeLogin:{type:Boolean},showForgetPassword:{type:Boolean},showQrcodeLogin:{type:Boolean},showRegister:{type:Boolean},showRememberMe:{type:Boolean},showThirdPartyLogin:{type:Boolean},subTitle:{},title:{},submitButtonText:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(T){const d=ue(T,"open"),[e,m]=x();return N(()=>d.value,s=>{m.setState({isOpen:s})}),(s,i)=>(S(),P("div",null,[p(t(e),{closable:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,footer:!1,"fullscreen-button":!1,header:!1,class:"border-none px-10 py-6 text-center shadow-xl sm:w-[600px] sm:rounded-2xl md:h-[unset]"},{default:v(()=>[p(t(Ce),{src:s.avatar,class:"mx-auto mb-6 size-20"},null,8,["src"]),p(t(q),{"show-forget-password":!1,"show-register":!1,"show-remember-me":!1,"sub-title":s.$t("authentication.loginAgainSubTitle"),title:s.$t("authentication.loginAgainTitle")},{default:v(()=>[ce(s.$slots,"default")]),_:3},8,["sub-title","title"])]),_:3})]))}});function Se(T){return U(this,null,function*(){const e=V().accessUserId;return H.put(`user/user_id/${e}/timezone`,T)})}const xe=D({__name:"domain-select",setup(T){const{isMobile:d}=E(),e=le(),m=k([]),s=k([]),i=k(),g=Z(),f=new Set(["UserClientDistributionWorld","UserClientHistoryOnline","UserClientHistoryRate","UserClientHistoryRebuffer","UserClientLiveDataPerApp"]),r=$(()=>f.has(g.name)),[c,l]=W({handleSubmit:a=>{b(a.domain)},layout:"vertical",schema:[{component:"Select",componentProps:{placeholder:"Domain",class:"w-full",onChange:b},fieldName:"domain",label:"Domain",rules:"required"}],showDefaultActions:!1}),[_,u]=x({footer:!1,onConfirm:()=>{l.submitForm(),u.close()}});function b(a){var n;const o=e.domains.find(Y=>`${Y.id}`===a);o&&(e.setCurrentDomain(o),(n=u==null?void 0:u.close)==null||n.call(u))}function w(){me(()=>{l.updateSchema([{fieldName:"domain",componentProps:{options:m.value}}])})}O(()=>U(this,null,function*(){const a=yield e.fetchAllDomainAndAppLogic();s.value=a,m.value=a.map(n=>({label:n.domain,value:`${n.id}`}));const o=e.currentDomain;if(o)i.value=`${o==null?void 0:o.id}`,l.setValues({domain:`${o==null?void 0:o.id}`});else{const n=a[0];if(!n)return;i.value=`${n==null?void 0:n.id}`,l.setValues({domain:`${n==null?void 0:n.id}`}),e.setCurrentDomain(n)}w()})),N(()=>e.domains,()=>{const a=e.domains;s.value=a,m.value=a.map(o=>({label:o.domain,value:`${o.id}`})),w()}),N(()=>e.currentDomain,()=>{var a,o;i.value=`${(a=e.currentDomain)==null?void 0:a.id}`,l.setValues({domain:`${(o=e.currentDomain)==null?void 0:o.id}`})});function h(){var o;const a=X();if(a)i.value=`${a==null?void 0:a.id}`,l.setValues({domain:`${a==null?void 0:a.id}`});else{const n=(o=s.value)==null?void 0:o[0];if(!n)return;i.value=`${n==null?void 0:n.id}`,l.setValues({domain:`${n==null?void 0:n.id}`}),e.setCurrentDomain(n)}}function y(){u.open(),h()}return(a,o)=>(S(),P(de,null,[r.value&&!t(d)?(S(),M(t(J),{key:0,value:i.value,"onUpdate:value":o[0]||(o[0]=n=>i.value=n),options:m.value,class:"mr-5 md:w-[200px]",placeholder:"Domain",onChange:b},null,8,["value","options"])):B("",!0),r.value&&t(d)?(S(),P("div",{key:1,class:"flex items-center",onClick:y},[p(t(_),{title:"Domain"},{default:v(()=>[p(t(c))]),_:1}),o[1]||(o[1]=I("span",{class:"icon-[tabler--list-search] anticon text-foreground/70 mr-1.5 size-3",style:{width:"24px",height:"24px"}},null,-1))])):B("",!0)],64))}}),$e=["innerHTML"],De=D({__name:"recharge-modal",setup(T){const{locale:d}=R(),e=$(()=>d.value==="en-US"?"USD":"CNY"),m=Q(),[s,i]=F({layout:"vertical",handleSubmit:r,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"InputNumber",fieldName:"price",label:"Price",rules:G().min(e.value==="CNY"?100:10,{message:d.value==="en-US"?"The minimum recharge amount is 10":"最低充值金额为100"}).refine(c=>{const u=(e.value==="CNY"?/^(10\d|[1-9]\d\d|[1-9]\d\d\d|[1-9]\d\d\d\d)$/:/^[1-9]\d*0$/).test(`${c}`);return!u&&Number(c)>(e.value==="CNY"?100:10)&&(L.destroy("recharge"),L.warning({key:"recharge",content:pe("div",{innerHTML:`<div>${C("page.myInfo.rechargeTip")}</div>`})})),u})}],showDefaultActions:!1}),[g,f]=x({onConfirm:()=>U(this,null,function*(){yield i.submitForm()})});function r(c){return U(this,null,function*(){if(!(yield i.validate()).valid)return;f.setState({loading:!0});const _=e.value==="CNY",u=_?"充值人民幣":"Recharge USD",b=Number(c.price),w={price:b,currency:e.value,goods:[{subject:u,amount:1,price:b}],goods_type:_?"recharge_cny":"recharge_usd"};be(w).then(h=>{m.push({name:"OrderDetail",query:{currency:e.value,orderID:h.order_id,totalPrice:b,buyData:JSON.stringify(w.goods)}}).then(()=>{f.close()})}).catch(h=>{console.error(h)}).finally(()=>{f.setState({loading:!1})})})}return(c,l)=>(S(),M(t(g),{title:t(C)("page.myInfo.recharge")},{description:v(()=>[I("div",{innerHTML:t(C)("page.myInfo.rechargeTip")},null,8,$e)]),default:v(()=>[p(t(s),{class:"mx-4"})]),_:1},8,["title"]))}}),Me=D({__name:"time-zone-modal",emits:["success"],setup(T,{emit:d}){const e=d,m=[{value:12,label:"UTC±12"},{value:11,label:"UTC+11"},{value:10,label:"UTC+10"},{value:9,label:"UTC+9"},{value:8,label:"UTC+8"},{value:7,label:"UTC+7"},{value:6,label:"UTC+6"},{value:5,label:"UTC+5"},{value:4,label:"UTC+4"},{value:3,label:"UTC+3"},{value:2,label:"UTC+2"},{value:1,label:"UTC+1"},{value:0,label:"UTC+0"},{value:-1,label:"UTC-1"},{value:-2,label:"UTC-2"},{value:-3,label:"UTC-3"},{value:-4,label:"UTC-4"},{value:-5,label:"UTC-5"},{value:-6,label:"UTC-6"},{value:-7,label:"UTC-7"},{value:-8,label:"UTC-8"},{value:-9,label:"UTC-9"},{value:-10,label:"UTC-10"},{value:-11,label:"UTC-11"}],s=z(),[i,g]=F({layout:"vertical",handleSubmit:c,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Select",fieldName:"zone",label:"Time Zone",componentProps:{options:m},rules:"required"}],showDefaultActions:!1}),[f,r]=x({onConfirm:()=>U(this,null,function*(){yield g.submitForm()})});function c(l){return U(this,null,function*(){if(!(yield g.validate()).valid)return;r.setState({loading:!0});const[u]=yield fe(Se({utc:l.zone}));r.setState({loading:!1}),!u&&(r.close(),K.success({message:C("common.success"),description:C("page.app.updateItemSuccess")}),e("success"))})}return O(()=>{var l;g.setValues({zone:(l=s.userInfo)==null?void 0:l.utc})}),(l,_)=>(S(),M(t(f),{description:t(C)("page.dashboard.changeUTCDesc"),title:t(C)("page.dashboard.changeUTC")},{default:v(()=>[p(t(i),{class:"mx-4"})]),_:1},8,["description","title"]))}}),Ae={class:"text-foreground/60 border-border flex items-center justify-between rounded-md border px-3 py-1.5 text-xs"},Ze=D({__name:"basic",setup(T){const{zoneOptions:d}=ee(),e=z(),m=ae(),s=V(),{locale:i}=R(),[g,f]=x({connectedComponent:Me}),[r,c]=x({connectedComponent:De}),l=$(()=>[{handler:()=>{const h=i.value==="en-US"?oe:te;he(h,{target:"_blank"})},icon:Ue,text:C("common.docUrl")},{handler:()=>{ne.push("/user/edit")},icon:A,text:C("page.navbar.myInfo")},{handler:()=>{w()},icon:A,text:C("page.myInfo.recharge")},{handler:()=>{f.open()},icon:A,text:C("page.dashboard.changeUTC")}]),_=$(()=>{var h,y;return(y=(h=e.userInfo)==null?void 0:h.avatar)!=null?y:ve.app.defaultAvatar}),u=$(()=>{var y;const h=se();return(y=d.value.find(a=>a.value===h))==null?void 0:y.label});function b(){return U(this,null,function*(){yield m.logout(!0)})}function w(){c.open()}return(h,y)=>(S(),M(t(_e),{onClearPreferencesAndLogout:b},{"header-left-1":v(()=>[I("div",Ae,ge(u.value),1)]),"user-dropdown":v(()=>{var a,o;return[p(t(ye),{description:(a=t(e).userInfo)==null?void 0:a.email,menus:l.value,text:(o=t(e).userInfo)==null?void 0:o.name,onLogout:b},null,8,["description","menus","text"])]}),extra:v(()=>[p(t(g)),p(t(r)),p(t(we),{open:t(s).loginExpired,"onUpdate:open":y[0]||(y[0]=a=>t(s).loginExpired=a),avatar:_.value},{default:v(()=>[p(re)]),_:1},8,["open","avatar"])]),"lock-screen":v(()=>[p(t(Te),{avatar:_.value,onToLogin:b},null,8,["avatar"])]),"header-right-1":v(()=>[p(xe)]),_:1}))}});export{Ze as default};
