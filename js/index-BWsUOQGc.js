var d=(D,g,m)=>new Promise((C,c)=>{var v=s=>{try{p(m.next(s))}catch(f){c(f)}},x=s=>{try{p(m.throw(s))}catch(f){c(f)}},p=s=>s.done?C(s.value):Promise.resolve(s.value).then(v,x);p((m=m.apply(D,g)).next())});import{w as E,$ as t,a as L,B as h,bf as M,x as O,y as S}from"./bootstrap-QC5HPXIW.js";import{u as R}from"./vxe-table-BTsW-ApG.js";import{f as q,s as F,d as I,a as Y}from"./domain-DYNLDaZf.js";import{u as H}from"./app-DUrdUZ6y.js";import{_ as J}from"./bind-drawer.vue_vue_type_script_setup_true_lang-B3-Orzy7.js";import{_ as K}from"./viladate-modal.vue_vue_type_script_setup_true_lang-k-rQnOYX.js";import{_ as Q}from"./page.vue_vue_type_script_setup_true_lang-C2EvkboD.js";import{_ as X}from"./copy-token.vue_vue_type_script_setup_true_lang-CtnMeoqo.js";import{a5 as Z,R as ee,Y as ae,af as k,ak as b,ah as i,ab as a,w as l,al as $,au as r,av as u,aj as w,bw as B}from"../jse/index-index-C5kN0FgG.js";import{u as te}from"./use-drawer-BaaVqxAC.js";import{u as oe}from"./use-modal-BWnJd4PN.js";import{P as ie}from"./index-HOolkvu8.js";import"./loading-CjfJb0X9.js";import"./form-Bsu9NQNs.js";import"./RightOutlined-DGpcx4_N.js";import"./index-Bdie2ufg.js";import"./index-BQx6IHvJ.js";import"./x-t2EEVmmI.js";import"./CopyOutlined-BianFqbF.js";import"./copy-DwUe13Ey.js";const se={class:"flex w-full flex-col md:flex-row"},ne={class:"mt-2 flex items-center md:ml-auto md:mt-0"},Se=Z({__name:"index",setup(D){const g=H(),m=L(),C=E(),c=ee(!1),[v,x]=te({connectedComponent:J}),[p,s]=oe({connectedComponent:K}),f=ae({checkboxConfig:{highlight:!0,labelField:"name"},columns:[{field:"domain",title:t("page.domain.domain"),minWidth:200},{field:"status",title:t("page.domain.status"),width:200,slots:{default:"status"}},{field:"operation",title:t("common.operation"),slots:{default:"operation"},width:200}],height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:n=>d(this,[n],function*({page:e}){const o=yield q({page:e.currentPage,page_size:e.pageSize,web:1}),_=yield F();return c.value=_.exist,{items:o,total:1e3}})}}}),[z,N]=R({gridOptions:f});function P(){x.open()}function A(){m.push("/user/guide/web")}function y(){return d(this,null,function*(){yield N.reload(),(yield g.fetchAllDomainAndAppLogic()).filter(n=>!n.native).length<=2&&A()})}function U(e){return d(this,null,function*(){const[n]=yield B(I(e.id));n||(S.success({description:t("common.deleteSuccess"),message:t("common.success")}),yield y())})}function W(e){return d(this,null,function*(){const n=C.accessUserId;m.push({name:"UserClientLiveDataPerApp"}).then(()=>{g.setCurrentDomain({uid:`${n}`,id:e.id,domain:e.domain,isValid:1,native:!1})})})}function G(e){return e.blocked?t("common.illegal"):e.reviewing?t("common.reviewing"):e.disable_p2p?t("common.userClosed"):e.isValid===0?t("page.domain.unavailable"):t("common.available")}function T(){return d(this,null,function*(){const[e]=yield B(Y({enabled:c.value}));e?c.value=!c.value:(S.success({message:t("common.success")}),yield y())})}function j(e){return d(this,null,function*(){s.setData(e),s.open()})}function V(e){return e.shadow||e.domain.endsWith(".localhost")||e.domain.endsWith(".superpeer")}return(e,n)=>(k(),b(a(Q),{description:a(t)("page.domain.desc"),"auto-content-height":""},{default:i(()=>[l(a(p)),l(a(v),{onSuccess:y}),l(a(z),null,{"toolbar-actions":i(()=>[$("div",se,[l(a(h),{class:"md:mr-2",type:"primary",onClick:P},{default:i(()=>[r(u(a(t)("page.domain.bindDomain")),1)]),_:1}),l(a(X),{class:"mt-3 w-full md:mt-0 md:w-1/5"}),l(a(h),{class:"mt-2 md:ml-auto md:mt-0",type:"dashed",onClick:A},{default:i(()=>[r(u(a(t)("common.guide")),1)]),_:1}),$("div",ne,[l(a(M),{checked:c.value,"onUpdate:checked":n[0]||(n[0]=o=>c.value=o),class:"mr-2",onChange:T},null,8,["checked"]),n[1]||(n[1]=r(" Token Only "))])])]),status:i(({row:o})=>[l(a(O),{color:o.blocked||!o.isValid||o.disable_p2p?"red":"success"},{default:i(()=>[r(u(G(o)),1)]),_:2},1032,["color"])]),operation:i(({row:o})=>[o.isValid?(k(),b(a(h),{key:0,size:"small",type:"link",onClick:_=>W(o)},{default:i(()=>[r(u(a(t)("page.app.watch")),1)]),_:2},1032,["onClick"])):w("",!0),o.isValid!==1?(k(),b(a(h),{key:1,size:"small",type:"link",onClick:_=>j(o)},{default:i(()=>[r(u(a(t)("page.domain.certification")),1)]),_:2},1032,["onClick"])):w("",!0),l(a(ie),{"cancel-text":a(t)("common.cancel"),disabled:V(o),"ok-text":a(t)("common.ok"),title:a(t)("common.sureDelete"),onConfirm:_=>U(o)},{default:i(()=>[V(o)?w("",!0):(k(),b(a(h),{key:0,danger:"",size:"small",type:"link"},{default:i(()=>[r(u(a(t)("common.delete")),1)]),_:1}))]),_:2},1032,["cancel-text","disabled","ok-text","title","onConfirm"])]),_:1})]),_:1},8,["description"]))}});export{Se as default};
