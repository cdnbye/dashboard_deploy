var T=(y,d,e)=>new Promise((m,s)=>{var i=r=>{try{f(e.next(r))}catch(c){s(c)}},v=r=>{try{f(e.throw(r))}catch(c){s(c)}},f=r=>r.done?m(r.value):Promise.resolve(r.value).then(i,v);f((e=e.apply(y,d)).next())});import{v as j,dc as q,w as V,D as H,i as E,o as Z,u as W,b9 as J,ay as X,bi as R,a as Q,db as G,c as L,$ as b,aA as z,z as K,d7 as ee,j as ae,dd as te,de as oe,df as ne,dg as k,k as se,f as re}from"./bootstrap-CkMOf_ks.js";import{u as le}from"./app-CIi5bRyD.js";import{a5 as D,aY as ie,aZ as ue,X as P,af as S,ag as I,w as p,ah as h,ab as n,ai as ce,R as N,J as $,a6 as O,ak as A,aj as B,al as M,F as de,n as me,e as pe,bw as fe,bJ as he,a2 as ve,av as be,au as ge}from"../jse/index-index-Dsf0VSis.js";import{u as x}from"./use-modal-C5TBk-jK.js";import{u as F}from"./form-2M7Ngajq.js";import{e as Ce}from"./order-KG8VS8O-.js";import{_ as _e,a as ye,b as Ue,c as Te}from"./layout.vue_vue_type_script_setup_true_lang-BpLsjNRI.js";import"./domain-C1xncDfG.js";import"./x-DG8pKHUf.js";import"./loading-qrt6bFpU.js";import"./theme-toggle.vue_vue_type_script_setup_true_lang-CtxW6TBN.js";import"./arrow-down-plalnEV_.js";import"./use-drawer-BJdQMjsw.js";import"./copy-DRsysm5T.js";import"./rotate-cw-D5EPwsL5.js";const we=j("BookOpenTextIcon",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]]),Se=D({name:"LoginExpiredModal",__name:"login-expired-modal",props:ie({avatar:{default:""},codeLoginPath:{},forgetPasswordPath:{},loading:{type:Boolean},qrCodeLoginPath:{},registerPath:{},showCodeLogin:{type:Boolean},showForgetPassword:{type:Boolean},showQrcodeLogin:{type:Boolean},showRegister:{type:Boolean},showRememberMe:{type:Boolean},showThirdPartyLogin:{type:Boolean},subTitle:{},title:{},submitButtonText:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(y){const d=ue(y,"open"),[e,m]=x();return P(()=>d.value,s=>{m.setState({isOpen:s})}),(s,i)=>(S(),I("div",null,[p(n(e),{closable:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,footer:!1,"fullscreen-button":!1,header:!1,class:"border-none px-10 py-6 text-center shadow-xl sm:w-[600px] sm:rounded-2xl md:h-[unset]"},{default:h(()=>[p(n(_e),{src:s.avatar,class:"mx-auto mb-6 size-20"},null,8,["src"]),p(n(q),{"show-forget-password":!1,"show-register":!1,"show-remember-me":!1,"sub-title":s.$t("authentication.loginAgainSubTitle"),title:s.$t("authentication.loginAgainTitle")},{default:h(()=>[ce(s.$slots,"default")]),_:3},8,["sub-title","title"])]),_:3})]))}});function xe(y){return T(this,null,function*(){const e=V().accessUserId;return H.put(`user/user_id/${e}/timezone`,y)})}const $e=D({__name:"domain-select",setup(y){const{isMobile:d}=E(),e=le(),m=N([]),s=N([]),i=N(),v=Z(),f=new Set(["UserClientDistributionWorld","UserClientHistoryOnline","UserClientHistoryRate","UserClientHistoryRebuffer","UserClientLiveDataPerApp"]),r=$(()=>f.has(v.name)),[c,l]=W({handleSubmit:a=>{C(a.domain)},layout:"vertical",schema:[{component:"Select",componentProps:{placeholder:"Domain",class:"w-full",onChange:C},fieldName:"domain",label:"Domain",rules:"required"}],showDefaultActions:!1}),[g,u]=x({footer:!1,onConfirm:()=>{l.submitForm(),u.close()}});function C(a){var o;const t=e.domains.find(Y=>`${Y.id}`===a);t&&(e.setCurrentDomain(t),(o=u==null?void 0:u.close)==null||o.call(u))}function U(){me(()=>{l.updateSchema([{fieldName:"domain",componentProps:{options:m.value}}])})}O(()=>T(this,null,function*(){const a=yield e.fetchAllDomainAndAppLogic();s.value=a,m.value=a.map(o=>({label:o.domain,value:`${o.id}`}));const t=e.currentDomain;if(t)i.value=`${t==null?void 0:t.id}`,l.setValues({domain:`${t==null?void 0:t.id}`});else{const o=a[0];if(!o)return;i.value=`${o==null?void 0:o.id}`,l.setValues({domain:`${o==null?void 0:o.id}`}),e.setCurrentDomain(o)}U()})),P(()=>e.domains,()=>{const a=e.domains;s.value=a,m.value=a.map(t=>({label:t.domain,value:`${t.id}`})),U()}),P(()=>e.currentDomain,()=>{var a,t;i.value=`${(a=e.currentDomain)==null?void 0:a.id}`,l.setValues({domain:`${(t=e.currentDomain)==null?void 0:t.id}`})});function w(){var t;const a=X();if(a)i.value=`${a==null?void 0:a.id}`,l.setValues({domain:`${a==null?void 0:a.id}`});else{const o=(t=s.value)==null?void 0:t[0];if(!o)return;i.value=`${o==null?void 0:o.id}`,l.setValues({domain:`${o==null?void 0:o.id}`}),e.setCurrentDomain(o)}}function _(){u.open(),w()}return(a,t)=>(S(),I(de,null,[r.value&&!n(d)?(S(),A(n(J),{key:0,value:i.value,"onUpdate:value":t[0]||(t[0]=o=>i.value=o),options:m.value,class:"mr-5 md:w-[200px]",placeholder:"Domain",onChange:C},null,8,["value","options"])):B("",!0),r.value&&n(d)?(S(),I("div",{key:1,class:"flex items-center",onClick:_},[p(n(g),{title:"Domain"},{default:h(()=>[p(n(c))]),_:1}),t[1]||(t[1]=M("span",{class:"icon-[tabler--list-search] anticon text-foreground/70 mr-1.5 size-3",style:{width:"24px",height:"24px"}},null,-1))])):B("",!0)],64))}}),De=["innerHTML"],Me=D({__name:"recharge-modal",setup(y){const{locale:d}=R(),e=$(()=>d.value==="en-US"?"USD":"CNY"),m=Q(),[s,i]=F({layout:"vertical",handleSubmit:r,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"InputNumber",fieldName:"price",label:"Price",rules:G().min(e.value==="CNY"?100:10,{message:d.value==="en-US"?"The minimum recharge amount is 10":"最低充值金额为100"}).refine(c=>{const u=(e.value==="CNY"?/^(10\d|[1-9]\d\d|[1-9]\d\d\d|[1-9]\d\d\d\d)$/:/^[1-9]\d*0$/).test(`${c}`);return!u&&Number(c)>(e.value==="CNY"?100:10)&&(L.destroy("recharge"),L.warning({key:"recharge",content:pe("div",{innerHTML:`<div>${b("page.myInfo.rechargeTip")}</div>`})})),u})}],showDefaultActions:!1}),[v,f]=x({onConfirm:()=>T(this,null,function*(){yield i.submitForm()})});function r(c){return T(this,null,function*(){if(!(yield i.validate()).valid)return;f.setState({loading:!0});const g=e.value==="CNY",u=g?"充值人民幣":"Recharge USD",C=Number(c.price),U={price:C,currency:e.value,goods:[{subject:u,amount:1,price:C}],goods_type:g?"recharge_cny":"recharge_usd"};Ce(U).then(w=>{m.push({name:"OrderDetail",query:{currency:e.value,orderID:w.order_id,totalPrice:C,buyData:JSON.stringify(U.goods)}}).then(()=>{f.close()})}).catch(w=>{console.error(w)}).finally(()=>{f.setState({loading:!1})})})}return(c,l)=>(S(),A(n(v),{title:n(b)("page.myInfo.recharge")},{description:h(()=>[M("div",{innerHTML:n(b)("page.myInfo.rechargeTip")},null,8,De)]),default:h(()=>[p(n(s),{class:"mx-4"})]),_:1},8,["title"]))}}),Ae=D({__name:"time-zone-modal",emits:["success"],setup(y,{emit:d}){const e=d,m=[{value:12,label:"UTC±12"},{value:11,label:"UTC+11"},{value:10,label:"UTC+10"},{value:9,label:"UTC+9"},{value:8,label:"UTC+8"},{value:7,label:"UTC+7"},{value:6,label:"UTC+6"},{value:5,label:"UTC+5"},{value:4,label:"UTC+4"},{value:3,label:"UTC+3"},{value:2,label:"UTC+2"},{value:1,label:"UTC+1"},{value:0,label:"UTC+0"},{value:-1,label:"UTC-1"},{value:-2,label:"UTC-2"},{value:-3,label:"UTC-3"},{value:-4,label:"UTC-4"},{value:-5,label:"UTC-5"},{value:-6,label:"UTC-6"},{value:-7,label:"UTC-7"},{value:-8,label:"UTC-8"},{value:-9,label:"UTC-9"},{value:-10,label:"UTC-10"},{value:-11,label:"UTC-11"}],s=z(),[i,v]=F({layout:"vertical",handleSubmit:c,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Select",fieldName:"zone",label:"Time Zone",componentProps:{options:m},rules:"required"}],showDefaultActions:!1}),[f,r]=x({onConfirm:()=>T(this,null,function*(){yield v.submitForm()})});function c(l){return T(this,null,function*(){if(!(yield v.validate()).valid)return;r.setState({loading:!0});const[u]=yield fe(xe({utc:l.zone}));r.setState({loading:!1}),!u&&(r.close(),K.success({message:b("common.success"),description:b("page.app.updateItemSuccess")}),e("success"))})}return O(()=>{var l;v.setValues({zone:(l=s.userInfo)==null?void 0:l.utc})}),(l,g)=>(S(),A(n(f),{description:n(b)("page.dashboard.changeUTCDesc"),title:n(b)("page.dashboard.changeUTC")},{default:h(()=>[p(n(i),{class:"mx-4"})]),_:1},8,["description","title"]))}}),ke={class:"text-foreground/60 border-border flex items-center justify-between rounded-md border px-3 py-1.5 text-xs"},Ne=["src"],Je=D({__name:"basic",setup(y){const{zoneOptions:d}=ee(),e=z(),m=ae(),s=V(),{locale:i}=R(),[v,f]=x({connectedComponent:Ae}),[r,c]=x({connectedComponent:Me}),l=$(()=>[{handler:()=>{const _=i.value==="en-US"?te:oe;he(_,{target:"_blank"})},icon:we,text:b("common.docUrl")},{handler:()=>{ne.push("/user/edit")},icon:k,text:b("page.navbar.myInfo")},{handler:()=>{w()},icon:k,text:b("page.myInfo.recharge")},{handler:()=>{f.open()},icon:k,text:b("page.dashboard.changeUTC")}]),g=$(()=>{var _,a;return(a=(_=e.userInfo)==null?void 0:_.avatar)!=null?a:ve.app.defaultAvatar}),u={p0:"34",p1:"13",p2:"15",p3:"14"},C=$(()=>{var a;const _=se();return{label:(a=d.value.find(t=>t.value===_))==null?void 0:a.label,monitorUrl:`https://status.swarmcloud.net:2083/api/badge/${u[_]}/status`}});function U(){return T(this,null,function*(){yield m.logout(!0)})}function w(){c.open()}return(_,a)=>(S(),A(n(ye),{onClearPreferencesAndLogout:U},{"header-left-1":h(()=>[M("div",ke,be(C.value.label),1),a[1]||(a[1]=ge("   ")),M("img",{src:C.value.monitorUrl,alt:"Unknown"},null,8,Ne)]),"user-dropdown":h(()=>{var t,o;return[p(n(Ue),{description:(t=n(e).userInfo)==null?void 0:t.email,menus:l.value,text:(o=n(e).userInfo)==null?void 0:o.name,onLogout:U},null,8,["description","menus","text"])]}),extra:h(()=>[p(n(v)),p(n(r)),p(n(Se),{open:n(s).loginExpired,"onUpdate:open":a[0]||(a[0]=t=>n(s).loginExpired=t),avatar:g.value},{default:h(()=>[p(re)]),_:1},8,["open","avatar"])]),"lock-screen":h(()=>[p(n(Te),{avatar:g.value,onToLogin:U},null,8,["avatar"])]),"header-right-1":h(()=>[p($e)]),_:1}))}});export{Je as default};
