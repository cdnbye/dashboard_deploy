var N=Object.defineProperty;var V=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var B=(g,r,n)=>r in g?N(g,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):g[r]=n,O=(g,r)=>{for(var n in r||(r={}))P.call(r,n)&&B(g,n,r[n]);if(V)for(var n of V(r))W.call(r,n)&&B(g,n,r[n]);return g};var U=(g,r,n)=>new Promise((w,k)=>{var x=c=>{try{b(n.next(c))}catch(v){k(v)}},z=c=>{try{b(n.throw(c))}catch(v){k(v)}},b=c=>c.done?w(c.value):Promise.resolve(c.value).then(x,z);b((n=n.apply(g,r)).next())});import{d6 as $,$ as u,k as D,d7 as j,b8 as G,d8 as L,d9 as R,I as T,b6 as I,B as K,d5 as Y,y as E}from"./bootstrap-CL17rep8.js";import{u as Z}from"./vxe-table-7XJ7DyGq.js";import{f as q}from"./domain-DVItbrBE.js";import{u as H}from"./p2p-BlEEM_Zz.js";import{_ as J}from"./page.vue_vue_type_script_setup_true_lang-Bmglc92S.js";import{a5 as Q,J as X,R as aa,Y as ea,af as p,ak as h,ah as o,ab as t,al as F,av as _,au as A,w as m,ag as y,an as C,F as S,aj as la,bw as sa}from"../jse/index-index-BG6jV3fR.js";import"./loading-DyJFSIH5.js";import"./form-DVKcOcK9.js";import"./RightOutlined-C1bagf8s.js";import"./x-BMVsyMFc.js";const na={class:"text-foreground/60 mb-3"},ta="*Apply To All*",ba=Q({__name:"signal-manage",setup(g){const{zoneOptions:r}=$(),n=X(()=>{var d;const s=D();return(d=r.value.find(a=>a.value===s))==null?void 0:d.label}),w=aa([{label:"Europe",options:[{value:"wss://signalcloud.swarmcloud.org",label:"Germany"}]},{label:"America",options:[{value:"wss://opensignal.swarmcloud.org",label:"USA"},{value:"wss://br.swarmcloud.org",label:"Brazil"}]},{label:"Asia-Pacific",options:[{value:"wss://signal.swarmcloud.org",label:"HongKong"},{value:"wss://sg.swarmcloud.org",label:"Singapore"},{value:"wss://kr.swarmcloud.org",label:"South Korea"},{value:"wss://au.swarmcloud.org",label:"Australia"},{value:"wss://vn.swarmcloud.org",label:"Vietnam"},{value:"wss://ae.swarmcloud.org",label:"UAE"}]},{label:"Africa",options:[{value:"wss://za.swarmcloud.org",label:"South Africa"}]},{label:"Chinese Mainland",options:[{value:"wss://gz.swarmcloud.net",label:"Guangzhou"}]}]),k=(s,d)=>{s.signals=[d].join(`
`)},x=(s,d)=>{s.signals2=[d].join(`
`)},z=ea({checkboxConfig:{highlight:!0,labelField:"name"},columns:[{field:"domain",title:u("page.p2p.name"),minWidth:250},{field:"addr",title:u("page.p2p.signalAddr"),slots:{default:"addr"},minWidth:200},{field:"addr2",title:u("page.p2p.signalAddr2"),slots:{default:"addr2"},minWidth:200},{field:"switch",title:u("page.p2p.signalSwitch"),slots:{default:"switch"},width:100},{field:"operation",title:u("common.operation"),slots:{default:"operation"},width:100}],editConfig:{mode:"cell",trigger:"manual"},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:d=>U(this,[d],function*({page:s}){var e,f;let a=yield q({page:s.currentPage,page_size:s.pageSize,isvalid:1});a.forEach(i=>{i.signals&&i.signals.length>=0&&(i.signals=i.signals.join(`
`)),i.signals2&&i.signals2.length>=0&&(i.signals2=i.signals2.join(`
`))});const l={};for(const i of a)if(i.domain.endsWith(".localhost")){l.signals=i.signals,l.signals2=i.signals2,l.signal_enabled=i.signal_enabled;break}return a=a.filter(i=>!i.blocked),a.length>1&&a.unshift(O({uid:(e=a==null?void 0:a[0])==null?void 0:e.uid,domain:ta,id:0,blocked:!1,signal_enabled:(f=a==null?void 0:a[0])==null?void 0:f.signal_enabled},l)),{items:a,total:1e3}})}}}),[b,c]=Z({gridOptions:z});function v(s){let d=[],a=[];s.signals&&(d=s.signals.split(`
`).map(e=>e.trim()).filter(e=>e!=="")),s.signals2&&(a=s.signals2.split(`
`).map(e=>e.trim()).filter(e=>e!==""));const l={signals:d,signals2:a,enabled:s.signal_enabled};M(s.id,l)}function M(s,d){return U(this,null,function*(){c.setLoading(!0);const[a]=yield sa(H(s,d));if(c.setLoading(!1),a){E.error({description:u("page.p2p.configFail"),message:u("common.error")});return}E.success({description:u("page.p2p.configSuccess"),message:u("common.success")}),c.reload()})}return(s,d)=>(p(),h(t(J),{"auto-content-height":""},{description:o(()=>[F("div",null,[F("p",na,_(t(u)("page.p2p.signalManageDesc")),1),A(" "+_(t(u)("page.p2p.signalManageOfficial")),1)])]),default:o(()=>[m(t(b),null,{addr:o(({row:a})=>[m(t(j),{compact:""},{default:o(()=>{var l;return[m(t(G),{placeholder:((l=a.signals)==null?void 0:l.length)>0?"Select":n.value,class:"w-2/5",size:"small",style:{width:"130px"},onChange:e=>{k(a,e)}},{default:o(()=>[(p(!0),y(S,null,C(w.value,e=>(p(),h(t(L),{key:e.label,label:e.label},{default:o(()=>[(p(!0),y(S,null,C(e.options,f=>(p(),h(t(R),{key:f.value,value:f.value},{default:o(()=>[A(_(f.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["placeholder","onChange"]),m(t(T).TextArea,{value:a.signals,"onUpdate:value":e=>a.signals=e,"auto-size":{minRows:1,maxRows:10},"allow-clear":"",class:"w-3/5 text-left",placeholder:"wss://",size:"small"},null,8,["value","onUpdate:value"])]}),_:2},1024)]),addr2:o(({row:a})=>[m(t(j),{compact:""},{default:o(()=>[m(t(G),{class:"w-2/5",placeholder:"Select",size:"small",style:{width:"130px"},onChange:l=>{x(a,l)}},{default:o(()=>[(p(!0),y(S,null,C(w.value,l=>(p(),h(t(L),{key:l.label,label:l.label},{default:o(()=>[(p(!0),y(S,null,C(l.options,e=>(p(),h(t(R),{key:e.value,value:e.value},{default:o(()=>[A(_(e.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["onChange"]),m(t(T).TextArea,{value:a.signals2,"onUpdate:value":l=>a.signals2=l,"auto-size":{minRows:1,maxRows:10},"allow-clear":"",class:"w-3/5 text-left",placeholder:"wss://",size:"small"},null,8,["value","onUpdate:value"])]),_:2},1024)]),switch:o(({row:a})=>[a.blocked?la("",!0):(p(),h(t(I),{key:0,checked:a.signal_enabled,"onUpdate:checked":l=>a.signal_enabled=l},null,8,["checked","onUpdate:checked"]))]),operation:o(({row:a})=>[m(t(K),{type:"primary",onClick:Y(l=>v(a),["prevent"])},{default:o(()=>[A(_(t(u)("common.ok")),1)]),_:2},1032,["onClick"])]),_:1})]),_:1}))}});export{ba as default};
