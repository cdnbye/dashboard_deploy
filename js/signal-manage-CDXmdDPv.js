var M=Object.defineProperty;var V=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var j=(g,r,n)=>r in g?M(g,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):g[r]=n,O=(g,r)=>{for(var n in r||(r={}))N.call(r,n)&&j(g,n,r[n]);if(V)for(var n of V(r))P.call(r,n)&&j(g,n,r[n]);return g};var U=(g,r,n)=>new Promise((_,k)=>{var y=c=>{try{b(n.next(c))}catch(v){k(v)}},z=c=>{try{b(n.throw(c))}catch(v){k(v)}},b=c=>c.done?_(c.value):Promise.resolve(c.value).then(y,z);b((n=n.apply(g,r)).next())});import{d7 as W,$ as u,k as $,d8 as B,b9 as G,d9 as L,da as T,I as R,b7 as D,x as J,d6 as K,z as E}from"./bootstrap-CiyWlmzu.js";import{u as Y}from"./vxe-table-B3uN1EwY.js";import{f as Z}from"./domain-DxFU4Atk.js";import{u as q}from"./p2p-BSmMGjdU.js";import{_ as H}from"./page.vue_vue_type_script_setup_true_lang-CQ_GieV6.js";import{a5 as Q,J as X,R as aa,Y as ea,af as p,ak as h,ah as o,ab as t,al as F,av as w,au as A,w as m,ag as x,an as C,F as S,aj as la,bw as sa}from"../jse/index-index-DX6TcLw_.js";import"./loading-C3dzF5Xb.js";import"./form-Cbk7_7El.js";import"./RightOutlined-oamSFcRw.js";import"./x-COcrQ3Ng.js";const na={class:"text-foreground/60 mb-3"},ta="*Apply To All*",ba=Q({__name:"signal-manage",setup(g){const{zoneOptions:r}=W(),n=X(()=>{var d;const s=$();return(d=r.value.find(a=>a.value===s))==null?void 0:d.label}),_=aa([{label:"Europe",options:[{value:"wss://signalcloud.swarmcloud.org",label:"Germany"}]},{label:"America",options:[{value:"wss://opensignal.swarmcloud.org",label:"USA"},{value:"wss://br.swarmcloud.org",label:"Brazil"}]},{label:"Asia-Pacific",options:[{value:"wss://signal.swarmcloud.org",label:"HongKong"},{value:"wss://sg.swarmcloud.org",label:"Singapore"},{value:"wss://idn.swarmcloud.org",label:"Indonesia"},{value:"wss://jp.swarmcloud.org",label:"Japan"},{value:"wss://kr.swarmcloud.org",label:"South Korea"},{value:"wss://th.swarmcloud.org",label:"Thailand"},{value:"wss://vn.swarmcloud.org",label:"Vietnam"},{value:"wss://ae.swarmcloud.org",label:"UAE"}]},{label:"Africa",options:[{value:"wss://za.swarmcloud.org",label:"South Africa"}]},{label:"Chinese Mainland",options:[{value:"wss://gz.swarmcloud.net",label:"Guangzhou"}]}]),k=(s,d)=>{s.signals=[d].join(`
`)},y=(s,d)=>{s.signals2=[d].join(`
`)},z=ea({checkboxConfig:{highlight:!0,labelField:"name"},columns:[{field:"domain",title:u("page.p2p.name"),minWidth:250},{field:"addr",title:u("page.p2p.signalAddr"),slots:{default:"addr"},minWidth:200},{field:"addr2",title:u("page.p2p.signalAddr2"),slots:{default:"addr2"},minWidth:200},{field:"switch",title:u("page.p2p.signalSwitch"),slots:{default:"switch"},width:100},{field:"operation",title:u("common.operation"),slots:{default:"operation"},width:100}],editConfig:{mode:"cell",trigger:"manual"},height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:d=>U(this,[d],function*({page:s}){var e,f;let a=yield Z({page:s.currentPage,page_size:s.pageSize,isvalid:1});a.forEach(i=>{i.signals&&i.signals.length>=0&&(i.signals=i.signals.join(`
`)),i.signals2&&i.signals2.length>=0&&(i.signals2=i.signals2.join(`
`))});const l={};for(const i of a)if(i.domain.endsWith(".localhost")){l.signals=i.signals,l.signals2=i.signals2,l.signal_enabled=i.signal_enabled;break}return a=a.filter(i=>!i.blocked),a.length>1&&a.unshift(O({uid:(e=a==null?void 0:a[0])==null?void 0:e.uid,domain:ta,id:0,blocked:!1,signal_enabled:(f=a==null?void 0:a[0])==null?void 0:f.signal_enabled},l)),{items:a,total:1e3}})}}}),[b,c]=Y({gridOptions:z});function v(s){let d=[],a=[];s.signals&&(d=s.signals.split(`
`).map(e=>e.trim()).filter(e=>e!=="")),s.signals2&&(a=s.signals2.split(`
`).map(e=>e.trim()).filter(e=>e!==""));const l={signals:d,signals2:a,enabled:s.signal_enabled};I(s.id,l)}function I(s,d){return U(this,null,function*(){c.setLoading(!0);const[a]=yield sa(q(s,d));if(c.setLoading(!1),a){E.error({description:u("page.p2p.configFail"),message:u("common.error")});return}E.success({description:u("page.p2p.configSuccess"),message:u("common.success")}),c.reload()})}return(s,d)=>(p(),h(t(H),{"auto-content-height":""},{description:o(()=>[F("div",null,[F("p",na,w(t(u)("page.p2p.signalManageDesc")),1),A(" "+w(t(u)("page.p2p.signalManageOfficial")),1)])]),default:o(()=>[m(t(b),null,{addr:o(({row:a})=>[m(t(B),{compact:""},{default:o(()=>{var l;return[m(t(G),{placeholder:((l=a.signals)==null?void 0:l.length)>0?"Select":n.value,class:"w-2/5",size:"small",style:{width:"130px"},onChange:e=>{k(a,e)}},{default:o(()=>[(p(!0),x(S,null,C(_.value,e=>(p(),h(t(L),{key:e.label,label:e.label},{default:o(()=>[(p(!0),x(S,null,C(e.options,f=>(p(),h(t(T),{key:f.value,value:f.value},{default:o(()=>[A(w(f.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["placeholder","onChange"]),m(t(R).TextArea,{value:a.signals,"onUpdate:value":e=>a.signals=e,"auto-size":{minRows:1,maxRows:10},"allow-clear":"",class:"w-3/5 text-left",placeholder:"wss://",size:"small"},null,8,["value","onUpdate:value"])]}),_:2},1024)]),addr2:o(({row:a})=>[m(t(B),{compact:""},{default:o(()=>[m(t(G),{class:"w-2/5",placeholder:"Select",size:"small",style:{width:"130px"},onChange:l=>{y(a,l)}},{default:o(()=>[(p(!0),x(S,null,C(_.value,l=>(p(),h(t(L),{key:l.label,label:l.label},{default:o(()=>[(p(!0),x(S,null,C(l.options,e=>(p(),h(t(T),{key:e.value,value:e.value},{default:o(()=>[A(w(e.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["label"]))),128))]),_:2},1032,["onChange"]),m(t(R).TextArea,{value:a.signals2,"onUpdate:value":l=>a.signals2=l,"auto-size":{minRows:1,maxRows:10},"allow-clear":"",class:"w-3/5 text-left",placeholder:"wss://",size:"small"},null,8,["value","onUpdate:value"])]),_:2},1024)]),switch:o(({row:a})=>[a.blocked?la("",!0):(p(),h(t(D),{key:0,checked:a.signal_enabled,"onUpdate:checked":l=>a.signal_enabled=l},null,8,["checked","onUpdate:checked"]))]),operation:o(({row:a})=>[m(t(J),{type:"primary",onClick:K(l=>v(a),["prevent"])},{default:o(()=>[A(w(t(u)("common.ok")),1)]),_:2},1032,["onClick"])]),_:1})]),_:1}))}});export{ba as default};
