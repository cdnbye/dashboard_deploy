var N=Object.defineProperty,S=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var y=(l,t,e)=>t in l?N(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,f=(l,t)=>{for(var e in t||(t={}))C.call(t,e)&&y(l,e,t[e]);if(w)for(var e of w(t))D.call(t,e)&&y(l,e,t[e]);return l},d=(l,t)=>S(l,k(t));var v=(l,t,e)=>new Promise((r,n)=>{var c=a=>{try{s(e.next(a))}catch(o){n(o)}},i=a=>{try{s(e.throw(a))}catch(o){n(o)}},s=a=>a.done?r(a.value):Promise.resolve(a.value).then(c,i);s((e=e.apply(l,t)).next())});import{$ as b,y as x}from"./bootstrap-PGBUDbCq.js";import{u as P}from"./form-n2PTTWpZ.js";import{a as F}from"./seeder-CblL_hS0.js";import{a5 as T,bw as B,ag as M,ah as O,ai as $,n as q,ab as h}from"../jse/index-index-BXx06mpc.js";import{u as K}from"./use-modal-CEA9RQg3.js";const J=T({__name:"seed-modal",emits:["success"],setup(l,{emit:t}){const e=t,[r,n]=P({layout:"vertical",handleSubmit:s,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Input",fieldName:"channelId",label:"Channel ID",rules:"required"},{component:"Select",fieldName:"live",label:"Type",defaultValue:"live",componentProps:{options:[{label:"Live",value:"live"},{label:"VOD",value:"vod"}]}},{component:"InputNumber",fieldName:"priority",label:"Priority",defaultValue:100},{component:"Select",fieldName:"keepAlive",label:"KeepAlive",help:b("page.seeder.keepAliveTip"),defaultValue:"false",componentProps:{options:[{label:"false",value:"false"},{label:"true",value:"true"}]}}],showDefaultActions:!1}),[c,i]=K({onConfirm:()=>v(this,null,function*(){yield n.submitForm()}),onOpenChange(a){if(a){const o=i.getData();o&&n.setValues(o)}}});function s(a){return v(this,null,function*(){var _;if(!(yield n.validate()).valid)return;const m=(_=a.channelId)==null?void 0:_.trim(),A=Number(a.priority),p=i.getData();if(!m||!p.id)return;i.setState({loading:!0});let u=[];const g=m.split(`
`).filter(I=>!!I);g.length>1&&(u=g);const[V]=yield B(F(p.id,d(f(d(f({},a),{keepAlive:a.keepAlive==="true",live:a.live==="live",id:p.id,action:"seed"}),u.length>0?{channelIds:u}:{channelId:m}),{priority:A})));i.setState({loading:!1}),!V&&(i.close(),x.success({message:b("common.success")}),e("success"))})}return(a,o)=>(M(),O(h(c),{title:h(b)("page.seeder.createTitle")},{default:$(()=>[q(h(r),{class:"mx-4"})]),_:1},8,["title"]))}});export{J as _};
