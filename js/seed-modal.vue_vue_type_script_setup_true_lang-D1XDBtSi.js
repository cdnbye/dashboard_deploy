var I=Object.defineProperty,N=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var A=(l,t,e)=>t in l?I(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,f=(l,t)=>{for(var e in t||(t={}))C.call(t,e)&&A(l,e,t[e]);if(_)for(var e of _(t))D.call(t,e)&&A(l,e,t[e]);return l},d=(l,t)=>N(l,S(t));var v=(l,t,e)=>new Promise((r,s)=>{var c=a=>{try{n(e.next(a))}catch(o){s(o)}},i=a=>{try{n(e.throw(a))}catch(o){s(o)}},n=a=>a.done?r(a.value):Promise.resolve(a.value).then(c,i);n((e=e.apply(l,t)).next())});import{$ as b,z as x}from"./bootstrap-CiyWlmzu.js";import{u as P}from"./form-Cbk7_7El.js";import{a as F}from"./seeder-DTTqE7Nc.js";import{a5 as T,bw as B,af as M,ak as O,ah as $,w as q,ab as h}from"../jse/index-index-DX6TcLw_.js";import{u as z}from"./use-modal-DGRkTv3G.js";const J=T({__name:"seed-modal",emits:["success"],setup(l,{emit:t}){const e=t,[r,s]=P({layout:"vertical",handleSubmit:n,commonConfig:{componentProps:{class:"w-full"}},schema:[{component:"Input",fieldName:"channelId",label:"Channel ID",rules:"required"},{component:"Select",fieldName:"live",label:"Type",defaultValue:"live",componentProps:{options:[{label:"Live",value:"live"},{label:"VOD",value:"vod"}]}},{component:"InputNumber",fieldName:"priority",label:"Priority",defaultValue:100},{component:"Select",fieldName:"keepAlive",label:"KeepAlive",help:b("page.seeder.keepAliveTip"),defaultValue:"false",componentProps:{options:[{label:"false",value:"false"},{label:"true",value:"true"}]}}],showDefaultActions:!1}),[c,i]=z({onConfirm:()=>v(this,null,function*(){yield s.submitForm()}),onOpenChange(a){if(a){const o=i.getData();o&&s.setValues(o)}}});function n(a){return v(this,null,function*(){var w;if(!(yield s.validate()).valid)return;const m=(w=a.channelId)==null?void 0:w.trim(),y=Number(a.priority),p=i.getData();if(!m||!p.id)return;i.setState({loading:!0});let u=[];const g=m.split(`
`).filter(k=>!!k);g.length>1&&(u=g);const[V]=yield B(F(p.id,d(f(d(f({},a),{keepAlive:a.keepAlive==="true",live:a.live==="live",id:p.id,action:"seed"}),u.length>0?{channelIds:u}:{channelId:m}),{priority:y})));i.setState({loading:!1}),!V&&(i.close(),x.success({message:b("common.success")}),e("success"))})}return(a,o)=>(M(),O(h(c),{title:h(b)("page.seeder.createTitle")},{default:$(()=>[q(h(r),{class:"mx-4"})]),_:1},8,["title"]))}});export{J as _};
